<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My Blogger Posts</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="css/Chapter.css" />
    <link rel="stylesheet" href="css/blog.css" />
  </head>
  <body>
    <div class="we">
      <div class="top">
        <h1>Blogs and News</h1>
      </div>
    </div>
    <div class="container mt-5">
      <h1 class="mb-4">My Blogger Posts</h1>
      <div id="blog-posts" class="row"></div>
    </div>

    <script>
      const apiKey = "AIzaSyBEGcJMviEcWu5rbgc4FhGPU8r8OAgkTY0";

      function getBlogPosts() {
        const blogId = "5207560492914432337";
        const url = `https://www.googleapis.com/blogger/v3/blogs/${blogId}/posts?key=${apiKey}`;

        fetch(url)
          .then((response) => response.json())
          .then((data) => {
            const blogPostsContainer = document.getElementById("blog-posts");
            blogPostsContainer.innerHTML = "";

            if (data.items && data.items.length > 0) {
              data.items.forEach((post) => {
                const blogPost = document.createElement("div");
                blogPost.classList.add("blog-post", "col-md-4", "col-sm-6");

                const card = document.createElement("div");
                card.classList.add("card", "h-100");

                const cardBody = document.createElement("div");
                cardBody.classList.add("card-body");

                const titleLink = document.createElement("a");
                titleLink.href = post.url;
                titleLink.classList.add("blog-post-title", "card-title");
                titleLink.textContent = post.title;

                const authorInfo = document.createElement("div");
                authorInfo.classList.add(
                  "d-flex",
                  "align-items-center",
                  "mb-2"
                );

                const authorImg = document.createElement("img");
                authorImg.src = post.author.image.url;
                authorImg.alt = post.author.displayName;

                const authorDetails = document.createElement("div");
                const authorName = document.createElement("span");
                authorName.classList.add("ms-2", "fw-bold");
                authorName.textContent = post.author.displayName;

                const postDate = document.createElement("div");
                postDate.classList.add("text-muted");
                const date = new Date(post.published);
                postDate.textContent = `Published on: ${date.toLocaleDateString()}`;

                authorDetails.appendChild(authorName);
                authorDetails.appendChild(postDate);
                authorInfo.appendChild(authorImg);
                authorInfo.appendChild(authorDetails);

                const excerpt = document.createElement("p");
                excerpt.classList.add("blog-post-excerpt", "card-text");

                // Create a temporary div to extract text content
                const tempDiv = document.createElement("div");
                tempDiv.innerHTML = post.content;
                const textContent =
                  tempDiv.textContent || tempDiv.innerText || "";
                excerpt.textContent = textContent.slice(0, 100) + "...";

                cardBody.appendChild(authorInfo);
                cardBody.appendChild(titleLink);
                cardBody.appendChild(excerpt);
                card.appendChild(cardBody);
                blogPost.appendChild(card);

                blogPostsContainer.appendChild(blogPost);
              });
            } else {
              const message = document.createElement("p");
              message.textContent = "No blog posts found.";
              blogPostsContainer.appendChild(message);
            }
          })
          .catch((error) => {
            console.error(error);
            const message = document.createElement("p");
            message.textContent = "Error fetching blog posts.";
            document.getElementById("blog-posts").appendChild(message);
          });
      }

      getBlogPosts();
    </script>
  </body>
</html>
